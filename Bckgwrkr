Imports System.Net

Public Class Form1
    Private count As Integer
    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        count = 10 'nombre d'images à télécharger
        ProgressBar1.Maximum = count
        BackgroundWorker1.RunWorkerAsync()
    End Sub

    Private Sub BackgroundWorker1_DoWork(sender As Object, e As System.ComponentModel.DoWorkEventArgs) Handles BackgroundWorker1.DoWork
        For i As Integer = 1 To count
            'Téléchargement de l'image
            Using client As New WebClient()
                client.DownloadFile("http://example.com/image" & i & ".jpg", "image" & i & ".jpg")
            End Using
            BackgroundWorker1.ReportProgress(i)
        Next
    End Sub

    Private Sub BackgroundWorker1_ProgressChanged(sender As Object, e As System.ComponentModel.ProgressChangedEventArgs) Handles BackgroundWorker1.ProgressChanged
        Label1.Text = e.ProgressPercentage & " images téléchargées sur " & count
        ProgressBar1.Value = e.ProgressPercentage
    End Sub

    Private Sub BackgroundWorker1_RunWorkerCompleted(sender As Object, e As System.ComponentModel.RunWorkerCompletedEventArgs) Handles BackgroundWorker1.RunWorkerCompleted
        MessageBox.Show("Téléchargement terminé")
    End Sub
End Class
